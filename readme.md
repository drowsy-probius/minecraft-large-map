하나의 청크는 16x16의 블록으로 이루어져있음.
그러므로 이미지를 구성하고 scale한 결과가 16의 배수이어야 함.

그렇지 않으면 나중에 월드를 병합할 때 이미지로부터 생성되지 않은 보간된 지역이 포함될 것임.

---

1. 0_stretch_height_map.py 실행

```
before height: 0 255
RGBA 이미지를 그레이스케일로 변환했습니다.
이미지를 16비트로 변환하고 확대했습니다.
after height: 9216 65535
```
이런 식으로 결과가 나옴.

그러면 script.js 파일을 수정해야함.

height map의 최저점이 해수면이라고 가정할 때 변환된 height map의 최점이 9216이 나왔으므로 waterLevel을 계산해야 함.

script.js 파일에서 맵의 최고점을 1024, 최저점을 -512로 설정했을 때,인공 건축물을 위해서 지형의 높이의 최대는 768, 최소는 -386이라고 가정했음.

`.fromLevels(0, 65535).toLevels(0, 768)` 그러면 이라고 작성하면 됨.

저점은 0부터 매핑해야함.

다음은 해수면을 계산해야 함. worldPainter으로 직접 import height map한 뒤 숫자 바꿔가면서 확인해야함.

목표는 height map의 최저점이 해수면이고 그 때의 y 값이 0이 되는 것을 원함.

그러면 대충 y + scaling 된 값 하면 될 것 같음.


```
0:9216:65535 = -512:x:768

y = x + 512
0:9216:65535 = 0:y:1280

(65535 - 0) * ratio = 1280
ratio ~= 0.019532

y = ratio * 9216 = 180.00

x = y - 512 = 180.00 - 512 = -332.00
```

이렇게 계산하면 water level은 -332 정도로 설정해야 함. world painter에서 설정하고 확인한 뒤 보정한다.

위 값을 설정하고 lowest vale는 -331로 나왔으니 `-332`는 설정 불가능한 값이 된다. 그래서 적절한 값을 찾아보니 -323이다. 대략 +9를 한 값이다.



그렇지만 개발 시 설정으로는 height map의 최저점이 0이라고 한다면 water level은 대략 -386 + 9 = -377 정도로 설정해도 무난한 것을 보임.

`.withWaterLevel(-377)`



---

2. 1_split_height_map.py 실행

---

3. 2_height_map_to_world.py 실행

---

4. 3_merge_worlds.py 실행

---